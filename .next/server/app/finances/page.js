(()=>{var e={};e.id=571,e.ids=[571],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},5315:e=>{"use strict";e.exports=require("path")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},22:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>g,tree:()=>c}),r(5525),r(8696),r(5866);var a=r(3191),s=r(8716),n=r(7922),i=r.n(n),o=r(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["finances",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5525)),"/Users/juandominguez/seamless-bp/app/finances/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,8696)),"/Users/juandominguez/seamless-bp/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/juandominguez/seamless-bp/app/finances/page.tsx"],u="/finances/page",m={require:r,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/finances/page",pathname:"/finances",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7193:(e,t,r)=>{let a={"02a31d77b1297419f970b2c98d03589bafa94e2f":()=>Promise.resolve().then(r.bind(r,5625)).then(e=>e.updateInvoiceField),"0ce00658e115f0c37c8194a5a3e0a52498b31ac7":()=>Promise.resolve().then(r.bind(r,5625)).then(e=>e.getInvoiceData)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={"02a31d77b1297419f970b2c98d03589bafa94e2f":s.bind(null,"02a31d77b1297419f970b2c98d03589bafa94e2f"),"0ce00658e115f0c37c8194a5a3e0a52498b31ac7":s.bind(null,"0ce00658e115f0c37c8194a5a3e0a52498b31ac7")}},5043:(e,t,r)=>{Promise.resolve().then(r.bind(r,6731)),Promise.resolve().then(r.bind(r,9058))},9058:(e,t,r)=>{"use strict";r.d(t,{InvoiceDataTable:()=>d});var a=r(326),s=r(7577),n=r(6508),i=r(1798),o=r(5940),l=r(772),c=r(4432);function d({columns:e,data:t,filterColumnId:r="invoice_number",filterPlaceholder:d="Filter by invoice #..."}){let[u,m]=s.useState([]),[g,p]=s.useState([]),x=(0,n.b7)({data:t,columns:e,getCoreRowModel:(0,i.sC)(),getPaginationRowModel:(0,i.G_)(),onSortingChange:m,getSortedRowModel:(0,i.tj)(),onColumnFiltersChange:p,getFilteredRowModel:(0,i.vL)(),state:{sorting:u,columnFilters:g},initialState:{pagination:{pageSize:10}}});return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center py-4",children:(0,a.jsx)(c.I,{placeholder:d,value:x.getColumn(r)?.getFilterValue()??"",onChange:e=>x.getColumn(r)?.setFilterValue(e.target.value),className:"max-w-sm"})}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(o.iA,{children:[(0,a.jsx)(o.xD,{children:x.getHeaderGroups().map(e=>(0,a.jsx)(o.SC,{children:e.headers.map(e=>(0,a.jsx)(o.ss,{children:e.isPlaceholder?null:(0,n.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(o.RM,{children:x.getRowModel().rows?.length?x.getRowModel().rows.map(e=>(0,a.jsx)(o.SC,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,a.jsx)(o.pj,{children:(0,n.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(o.SC,{children:(0,a.jsx)(o.pj,{colSpan:e.length,className:"h-24 text-center",children:"No results."})})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-2 py-4",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>x.previousPage(),disabled:!x.getCanPreviousPage(),children:"Previous"}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>x.nextPage(),disabled:!x.getCanNextPage(),children:"Next"})]})]})}},6731:(e,t,r)=>{"use strict";r.d(t,{columns:()=>c});var a=r(326),s=r(567);let n=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString()}catch(e){return"Invalid Date"}},i=e=>null==e?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),o={Sent:"bg-blue-500 hover:bg-blue-600",Overdue:"bg-red-500 hover:bg-red-600",Paid:"bg-green-500 hover:bg-green-600",Cancelled:"bg-gray-500 hover:bg-gray-600"},l={"Not paid":"bg-yellow-500 hover:bg-yellow-600",Paid:"bg-green-500 hover:bg-green-600",Cancelled:"bg-gray-500 hover:bg-gray-600"},c=[{accessorKey:"invoice_number",header:"Invoice #"},{accessorKey:"project_id",header:"Project",cell:({row:e})=>e.original.project_id},{accessorKey:"client_id",header:"Client",cell:({row:e})=>e.original.client_id},{accessorKey:"date_issued",header:"Issued",cell:({row:e})=>n(e.original.date_issued)},{accessorKey:"due_date",header:"Due",cell:({row:e})=>n(e.original.due_date)},{id:"amount_pre_gst",header:"Amount (Pre-GST)",cell:({row:e})=>i(e.original.invoice_amount)},{id:"gst_amount",header:"GST (5%)",cell:({row:e})=>i(.05*e.original.invoice_amount)},{id:"total_amount",header:"Total Amount",cell:({row:e})=>i(1.05*e.original.invoice_amount)},{accessorKey:"invoice_status",header:"Inv. Status",cell:({row:e})=>{let t=e.original.invoice_status;if(!t)return"-";let r=o[t]||"bg-gray-400";return(0,a.jsx)(s.C,{variant:"default",className:`${r} text-white`,children:t})}},{accessorKey:"payment_status",header:"Pmt. Status",cell:({row:e})=>{let t=e.original.payment_status;if(!t)return"-";let r=l[t]||"bg-gray-400";return(0,a.jsx)(s.C,{variant:"default",className:`${r} text-white`,children:t})}},{accessorKey:"payment_method",header:"Pmt. Method",cell:({row:e})=>e.original.payment_method||"-"},{accessorKey:"payment_terms",header:"Terms",cell:({row:e})=>e.original.payment_terms||"-"}]},567:(e,t,r)=>{"use strict";r.d(t,{C:()=>l});var a=r(326);r(7577);var s=r(4214),n=r(9360),i=r(7863);let o=(0,n.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,asChild:r=!1,...n}){let l=r?s.g7:"span";return(0,a.jsx)(l,{"data-slot":"badge",className:(0,i.cn)(o({variant:t}),e),...n})}},4432:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var a=r(326);r(7577);var s=r(7863);function n({className:e,type:t,...r}){return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}},5940:(e,t,r)=>{"use strict";r.d(t,{RM:()=>o,SC:()=>l,iA:()=>n,pj:()=>d,ss:()=>c,xD:()=>i});var a=r(326);r(7577);var s=r(7863);function n({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...t})})}function i({className:e,...t}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...t})}function o({className:e,...t}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...t})}function l({className:e,...t}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function c({className:e,...t}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function d({className:e,...t}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}},5525:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(9510),s=r(5625),n=r(8570);let i=(0,n.createProxy)(String.raw`/Users/juandominguez/seamless-bp/components/finances/columns.tsx#columns`),o=(0,n.createProxy)(String.raw`/Users/juandominguez/seamless-bp/components/finances/InvoiceDataTable.tsx#InvoiceDataTable`);var l=r(4303);async function c(){let{invoices:e,summary:t,error:r}=await (0,s.getInvoiceData)();return r?(0,a.jsxs)("div",{className:"text-red-500",children:["Error loading finance data: ",r.message]}):e?(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Finances"}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(l.Z,{title:"Total Receivables",value:t.totalReceivables,description:"Unpaid & Not Cancelled",formatAsCurrency:!0}),(0,a.jsx)(l.Z,{title:"Current Amount",value:t.totalCurrent,description:"Receivable & Not Overdue",formatAsCurrency:!0}),(0,a.jsx)(l.Z,{title:"Overdue Amount",value:t.totalOverdue,description:"Receivable & Past Due Date",formatAsCurrency:!0})]}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Invoices"}),(0,a.jsx)(o,{columns:i,data:e,filterColumnId:"invoice_number",filterPlaceholder:"Filter by Invoice #..."})]}):(0,a.jsx)("div",{children:"Loading invoices... or no invoices found."})}},4303:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var a=r(9510);r(1159);var s=r(5761),n=r(2386);function i(...e){return(0,n.m6)((0,s.W)(e))}function o({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card",className:i("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function l({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-header",className:i("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function c({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-title",className:i("leading-none font-semibold",e),...t})}function d({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-content",className:i("px-6",e),...t})}var u=r(8022),m=r(3632);let g=({title:e,value:t,trend:r,description:s,formatAsCurrency:n=!1})=>{let g=n?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(t)):t,p=null==r?null:r>=0?(0,a.jsx)(u.Z,{className:"size-4 text-green-500"}):(0,a.jsx)(m.Z,{className:"size-4 text-red-500"}),x=null==r?null:`${r>=0?"+":""}${r}%`;return(0,a.jsxs)(o,{children:[(0,a.jsx)(l,{className:"pb-2",children:(0,a.jsx)(c,{className:"text-sm font-medium",children:e})}),(0,a.jsxs)(d,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:g}),null!=r&&(0,a.jsxs)("p",{className:i("text-xs flex items-center gap-1",null==r?"text-muted-foreground":r>=0?"text-green-500":"text-red-500"),children:[p,x,s&&(0,a.jsx)("span",{className:"text-muted-foreground ml-1",children:s})]}),null==r&&s&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:s})]})]})}},5625:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getInvoiceData:()=>i,updateInvoiceField:()=>o});var a=r(4330);r(166);var s=r(9692),n=r(7708);async function i(){let e=await (0,s.R)(),t=new Date,{data:r,error:a}=await e.from("invoices").select("*").order("date_issued",{ascending:!1});if(a)return console.error("Error fetching invoices:",a),{invoices:null,summary:{totalReceivables:0,totalOverdue:0,totalCurrent:0},error:a};let n=0,i=0;r.forEach(e=>{"Not paid"===e.payment_status&&"Cancelled"!==e.invoice_status&&(n+=e.invoice_amount,e.due_date&&new Date(e.due_date)<t&&(i+=e.invoice_amount))});let o=n-i;return{invoices:r,summary:{totalReceivables:n,totalOverdue:i,totalCurrent:o},error:null}}async function o(e,t,r){let a=await (0,s.R)();if(!e||!t)return console.error("Missing invoiceId or field for update"),{success:!1,error:{message:"Invalid input",details:"",hint:"",code:""}};let{error:i}=await a.from("invoices").update({[t]:r}).eq("id",e);return i?(console.error(`Error updating invoice ${t}:`,i),{success:!1,error:i}):((0,n.revalidatePath)("/finances"),{success:!0,error:null})}(0,r(618).h)([i,o]),(0,a.j)("0ce00658e115f0c37c8194a5a3e0a52498b31ac7",i),(0,a.j)("02a31d77b1297419f970b2c98d03589bafa94e2f",o)},9692:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});var a=r(8641),s=r(1615);async function n(){let e=await (0,s.cookies)();return(0,a.createServerClient)("https://herpqcdwgbhwvbqxrzgz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhlcnBxY2R3Z2Jod3ZicXhyemd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ1NzMyMzMsImV4cCI6MjA2MDE0OTIzM30.yXo9_1CERhV8U7nO8OLmNucLjTGXYy3o4gSZowyBeO8",{cookies:{get:t=>e.get(t)?.value,set(t,r,a){try{e.set({name:t,value:r,...a})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})}},7481:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(6621);let s=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,37,621,449,341,123,758,520],()=>r(22));module.exports=a})();